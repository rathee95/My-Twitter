{% extends "base.html" %}
{% block script %}

<script>
    $(document).ready(function(){
        console.log("working");

        $.ajax({

            url:"api/tweet/", //to our api
            method:"GET",
            success: function(data)
            {
                $.each(data,function(key,value){
                    console.log(key)
                    console.log(value.user)
                    console.log(value.content)
                    var tweetkey = key;
                    var tweetContent  = value.content;
                    var tweetUser = value.user;
                    $('#tweet-container').append( "<div class=\"media\"> <div class=\"media-body\">" + tweetContent + "<br/> via " + tweetUser.username + " |  " + "<a href='#'>View</a>"+ "</div></div><hr>")
                })
            },
            error:function(data)
            {   
                console.log("error"),
                console.log(data)
            }

        })
    });
</script>
{% endblock script %}
 {% block title %} All Tweets {% endblock title %} 

 {% block content %}



<div class="row">
    <div class="col-sm-3 col-xs-12">
        <h1>{{ request.user }}</h1>
    </div>
    <div class="col-sm-9">
        {% if not request.GET.q %}
            <div class="">
            {% include "tweets/form.html" with form=create_form action_url=create_url btn_title='Tweet !!' %}
                
            </div>
            <hr/>
        {% endif %}

        <div id="tweet-container">
        </div>

        {% for object in object_list %}
        <div class="media">
            <div class="media-left">
                {% if object.image %}<img src="img_avatar1.png" class="media-object" style="width:60px"> {% endif %}
            </div>
            <div class="media-body">
                {{ object.content }}
                <br/> via {{ object.user }} |{{ object.timestamp|timesince }} ago | <a href="{{ object.get_absolute_url }}"> View</a>
            </div>
        </div>
         {% empty %} {% if request.GET.q %}
        <p>No Tweets found </p>
        {% else %}
        <p>No Tweets yet </p>
        {% endif %} {% endfor %}
    </div>
</div>
{% endblock %}
